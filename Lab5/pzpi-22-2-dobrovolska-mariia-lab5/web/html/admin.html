<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —ñ–Ω–∫—É–±–∞—Ç–æ—Ä–æ–º</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
</head>
<body>
   <nav class="navbar">
        <div class="navbar-brand">
            <span class="logo">üê£</span> Chicken Incubator
        </div>
        <ul class="navbar-nav">
            <li><a href="/html/dashboard.html" class="nav-link active">–ì–æ–ª–æ–≤–Ω–∞</a></li>
            <li><a href="/html/devices.html" class="nav-link">–ü—Ä–∏—Å—Ç—Ä–æ—ó</a></li>
            <li><a href="/html/alerts.html" class="nav-link">–°–ø–æ–≤—ñ—â–µ–Ω–Ω—è</a></li>
            <li><a href="/html/sensor-data.html" class="nav-link">–î–∞–Ω—ñ —Å–µ–Ω—Å–æ—Ä—ñ–≤</a></li>
            <li id="adminPanelLink" style="display: none;"><a href="/html/admin.html" class="nav-link">–ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</a></li>
        </ul>
        <div class="navbar-user">
            <div class="dropdown">
                <span id="userDropdownTrigger" class="dropdown-trigger">
                    <span id="userNameNav"></span> (<span id="userRoleNav"></span>)
                </span>
                <div class="dropdown-content" id="userDropdown">
                    <a href="/html/profile.html">–ü—Ä–æ—Ñ—ñ–ª—å</a>
                    <a href="#" id="logoutBtnDropdown">–í–∏—Ö—ñ–¥</a>
                </div>
            </div>
            <button id="logoutBtn" class="btn btn-sm secondary-btn hide-on-mobile" style="display: none;">–í–∏—Ö—ñ–¥</button>
        </div>
    </nav>

    <div class="container">
        <div class="content-header">
            <h1>–ü–∞–Ω–µ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1>
        </div>

        <div class="tab-navigation">
            <button class="tab-link active" data-tab="user-management">–ö–µ—Ä—É–≤–∞–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏</button>
            <button class="tab-link" data-tab="platform-stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏</button>
            <button class="tab-link" data-tab="system-monitoring">–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–∏</button>
        </div>

        <div id="user-managementTab" class="tab-content active">
            <div class="card">
                <h2>–°–ø–∏—Å–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</h2>
                <div class="table-filters">
                    <label for="userSearchInput">–ü–æ—à—É–∫ (Email/–Ü–º'—è):</label>
                    <input type="text" id="userSearchInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –¥–ª—è –ø–æ—à—É–∫—É...">
                    <label for="userRoleFilter">–†–æ–ª—å:</label>
                    <select id="userRoleFilter">
                        <option value="">–í—Å—ñ —Ä–æ–ª—ñ</option>
                        <option value="user">User</option>
                        <option value="admin">Admin</option>
                    </select>
                     <label for="userActiveFilter">–°—Ç–∞—Ç—É—Å:</label>
                    <select id="userActiveFilter">
                        <option value="">–í—Å—ñ</option>
                        <option value="true">–ê–∫—Ç–∏–≤–Ω—ñ</option>
                        <option value="false">–ù–µ–∞–∫—Ç–∏–≤–Ω—ñ</option>
                    </select>
                    <button class="btn btn-sm primary-btn" id="applyUserFiltersBtn">–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
                </div>
                <div class="table-responsive mt-20">
                    <table class="device-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>–Ü–º‚Äô—è</th>
                                <th>Email</th>
                                <th>–†–æ–ª—å</th>
                                <th>–ê–∫—Ç–∏–≤–Ω–∏–π</th>
                                <th>–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody id="usersTableBody">
                            </tbody>
                    </table>
                </div>
                <div class="pagination-controls mt-10">
                    <button id="prevUserPageBtn" class="btn btn-sm secondary-btn">–ü–æ–ø–µ—Ä–µ–¥–Ω—è</button>
                    <span id="currentUserPageSpan">–°—Ç–æ—Ä—ñ–Ω–∫–∞ 1</span>
                    <button id="nextUserPageBtn" class="btn btn-sm secondary-btn">–ù–∞—Å—Ç—É–ø–Ω–∞</button>
                </div>
                <div id="userManagementMessage" class="message-area mt-10"></div>
            </div>
        </div>

        <div id="platform-statsTab" class="tab-content">
            <div class="card">
                <h2>–ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏</h2>
                 <div class="table-filters">
                    <label for="platformStatsDaysFilter">–ü–µ—Ä—ñ–æ–¥ (–¥–Ω—ñ–≤):</label>
                    <select id="platformStatsDaysFilter">
                        <option value="7">7 –¥–Ω—ñ–≤</option>
                        <option value="30" selected>30 –¥–Ω—ñ–≤</option>
                        <option value="90">90 –¥–Ω—ñ–≤</option>
                    </select>
                </div>
                <div id="platformStatsCards" class="summary-grid mt-20">
                    </div>
                <h3 class="mt-20">–¢—Ä–µ–Ω–¥ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤</h3>
                <div class="chart-canvas-wrapper">
                    <canvas id="userRegistrationChart"></canvas>
                </div>
                <h3 class="mt-20">–°—Ç–∞—Ç—É—Å –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤</h3>
                <div class="chart-canvas-wrapper">
                    <canvas id="deviceStatusChart"></canvas>
                </div>
            </div>
        </div>

        <div id="system-monitoringTab" class="tab-content">
            <div class="card">
                <h2>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–µ—Ä–≤–µ—Ä</h2>
                <div id="serverInfoDisplay" class="device-detail-grid">
                    </div>
            </div>
            <div class="card mt-20">
                <h2>–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É —Å–∏—Å—Ç–µ–º–∏ (Health Check)</h2>
                <div id="healthCheckDisplay" class="device-detail-grid">
                     </div>
                <button id="refreshHealthCheckBtn" class="btn primary-btn mt-10">–û–Ω–æ–≤–∏—Ç–∏</button>
            </div>
        </div>
    </div>

    <div id="editUserRoleModal" class="modal" style="display:none;">
        <div class="modal-content card">
            <span class="close-button" onclick="document.getElementById('editUserRoleModal').style.display='none'">&times;</span>
            <h2>–ó–º—ñ–Ω–∏—Ç–∏ —Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</h2>
            <p>–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: <strong id="modalUserName"></strong> (<span id="modalUserEmail"></span>)</p>
            <input type="hidden" id="modalUserId">
            <div class="input-group">
                <label for="modalUserRoleSelect">–ù–æ–≤–∞ —Ä–æ–ª—å:</label>
                <select id="modalUserRoleSelect">
                    <option value="user">User</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
             <div class="input-group checkbox-group">
                <input type="checkbox" id="modalUserIsActive">
                <label for="modalUserIsActive">–ê–∫—Ç–∏–≤–Ω–∏–π</label>
            </div>
            <button id="saveUserRoleBtn" class="btn primary-btn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
            <div id="editUserModalMessage" class="message-area mt-10"></div>
        </div>
    </div>
    <style>
        .modal {
            position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%;
            overflow: auto; background-color: rgba(0,0,0,0.4); display: flex;
            align-items: center; justify-content: center;
        }
        .modal-content { background-color: #fefefe; padding: 20px; border-radius: 8px; width: 90%; max-width: 500px; text-align: left;}
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-button:hover, .close-button:focus { color: black; text-decoration: none; }
    </style>

    <script src="/js/admin.js"></script>
</body>
</html>