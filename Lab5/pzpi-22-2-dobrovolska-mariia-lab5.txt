ÐœÑ–Ð½Ñ–ÑÑ‚ÐµÑ€ÑÑ‚Ð²Ð¾ Ð¾ÑÐ²Ñ–Ñ‚Ð¸ Ñ– Ð½Ð°ÑƒÐºÐ¸ Ð£ÐºÑ€Ð°Ñ—Ð½Ð¸ Ð¥Ð°Ñ€ÐºÑ–Ð²ÑÑŒÐºÐ¸Ð¹ Ð½Ð°Ñ†Ñ–Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¸Ð¹ ÑƒÐ½Ñ–Ð²ÐµÑ€ÑÐ¸Ñ‚ÐµÑ‚ Ñ€Ð°Ð´Ñ–Ð¾ÐµÐ»ÐµÐºÑ‚Ñ€Ð¾Ð½Ñ–ÐºÐ¸

ÐšÐ°Ñ„ÐµÐ´Ñ€Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ð¾Ñ— Ñ–Ð½Ð¶ÐµÐ½ÐµÑ€Ñ–Ñ—

Ð—Ð²Ñ–Ñ‚
Ð— Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ñ— Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ â„–5
Ð— Ð´Ð¸ÑÑ†Ð¸Ð¿Ð»Ñ–Ð½Ð¸ Â«ÐÑ€Ñ…Ñ–Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÐµÐ½Ð½ÑÂ» Ð½Ð° Ñ‚ÐµÐ¼Ñƒ: Â«Ð ÐžÐ—Ð“ÐžÐ Ð¢ÐÐÐÐ¯ Ð¡Ð˜Ð¡Ð¢Ð•ÐœÐ˜Â»

Ð’Ð¸ÐºÐ¾Ð½Ð°Ð»Ð°:
ÑÑ‚. Ð³Ñ€. ÐŸÐ—ÐŸÐ†-22-7							Ð”Ð¾Ð±Ñ€Ð¾Ð²Ð¾Ð»ÑŒÑÑŒÐºÐ° Ðœ.Ð.

ÐŸÐµÑ€ÐµÐ²Ñ–Ñ€Ð¸Ð²:
ÑÑ‚. Ð²Ð¸ÐºÐ»Ð°Ð´Ð°Ñ‡ ÐºÐ°Ñ„. ÐŸÐ†						Ð¡Ð¾ÐºÐ¾Ñ€Ñ‡ÑƒÐº Ð†. ÐŸ.













Ð¥Ð°Ñ€ÐºÑ–Ð² 2025
 
1	Ð†Ð¡Ð¢ÐžÐ Ð†Ð¯ Ð—ÐœÐ†Ð


â„–	Ð”Ð°Ñ‚Ð°	      Ð’ÐµÑ€ÑÑ–Ñ Ð·Ð²Ñ–Ñ‚Ñƒ	ÐžÐ¿Ð¸Ñ	Ð·Ð¼Ñ–Ð½	Ñ‚Ð° Ð²Ð¸Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½ÑŒ
1	29.05.2025	0.1	          Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¾ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð·Ð²Ñ–Ñ‚Ñƒ. Ð’Ð¸Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¾ Ð·Ð°Ð²Ð´Ð°Ð½Ð½Ñ	Ð½Ð° Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ñƒ Ñ€Ð¾Ð±Ð¾Ñ‚Ñƒ
2	31.05.2025	0.1	          ÐžÐ¿Ð¸ÑÐ°Ð½Ð¾ Ñ…Ñ–Ð´ Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸, Ð´Ð¾Ð´Ð°Ñ‚Ð¾Ðº Ð, Ð´Ð¾Ð´Ð°Ñ‚Ð¾Ðº Ð‘, Ð´Ð¾Ð´Ð°Ñ‚Ð¾Ðº Ð’. Ð¡Ñ„Ð¾Ñ€Ð¼ÑƒÐ»ÑŒÐ¾Ð²Ð°Ð½Ð¾ Ð²Ð¸ÑÐ½Ð¾Ð²Ð¾Ðº Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸

2	Ð—ÐÐ’Ð”ÐÐÐÐ¯

ÐœÐµÑ‚Ð¾ÑŽ Ð´Ð°Ð½Ð¾Ð³Ð¾ Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð½ÑÑ‚Ñ‚Ñ Ñ” Ñ€Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ð¾Ñ— ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸.

3	ÐžÐŸÐ˜Ð¡ Ð’Ð˜ÐšÐžÐÐÐÐžÐ‡ Ð ÐžÐ‘ÐžÐ¢Ð˜

Ð£ Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð½Ñ Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ñ— Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ Ð±ÑƒÐ»Ð¾ Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ð¾ Ð¿Ð¾Ð²Ð½Ð¾Ñ†Ñ–Ð½Ð½Ðµ Ñ€Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ Ñ–Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ñ–Ð¹Ð½Ð¾-Ð°Ð½Ð°Ð»Ñ–Ñ‚Ð¸Ñ‡Ð½Ð¾Ñ— IoT-ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¾Ð²Ð°Ð½Ð¾Ð³Ð¾ Ð¼Ð¾Ð½Ñ–Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ñƒ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ–Ð² Ñ–Ð½ÐºÑƒÐ±Ð°Ñ†Ñ–Ñ—. Ð£ÑÑ– Ð³Ñ€Ð°Ñ„Ñ–Ñ‡Ð½Ñ– Ð¼Ð°Ñ‚ÐµÑ€Ñ–Ð°Ð»Ð¸ Ð²Ð¸Ð½ÐµÑÐµÐ½Ð¾ Ð´Ð¾ Ð´Ð¾Ð´Ð°Ñ‚ÐºÑƒ Ð‘, Ð° Ð²Ñ–Ð´ÐµÐ¾Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ â€“ Ð´Ð¾ Ð´Ð¾Ð´Ð°Ñ‚ÐºÑƒ Ð.
ÐŸÑ€Ð¾Ñ†ÐµÑ ÑÐºÐ»Ð°Ð´Ð°Ð²ÑÑ Ð· Ð´ÐµÐºÑ–Ð»ÑŒÐºÐ¾Ñ… ÐºÐ»ÑŽÑ‡Ð¾Ð²Ð¸Ñ… ÐµÑ‚Ð°Ð¿Ñ–Ð²:
1. ÐžÐ±Ñ€Ð°Ð½Ð½Ñ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð¸ Ð´Ð»Ñ Ñ€Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ
Ð”Ð»Ñ Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³Ñƒ Ð±ÑƒÐ»Ð¾ Ð¾Ð±Ñ€Ð°Ð½Ð¾ DigitalOcean, Ñ‰Ð¾ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÑƒÑ” Ð²Ð¸ÑÐ¾ÐºÑƒ ÑÑ‚Ð°Ð±Ñ–Ð»ÑŒÐ½Ñ–ÑÑ‚ÑŒ, Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ñ–ÑÑ‚ÑŒ ÐºÐµÑ€ÑƒÐ²Ð°Ð½Ð½Ñ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð¼ Ð½Ð° Ñ€Ñ–Ð²Ð½Ñ– ÐžÐ¡, Ð³Ð½ÑƒÑ‡ÐºÐµ Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð¼ÐµÑ€ÐµÐ¶ÐµÐ²Ð¸Ñ… Ð¿Ð¾Ð»Ñ–Ñ‚Ð¸Ðº, Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÑƒ Ð¿Ð¾ÑÑ‚Ñ–Ð¹Ð½Ð¸Ñ… Ð·â€™Ñ”Ð´Ð½Ð°Ð½ÑŒ (Ð½Ð°Ð¿Ñ€Ð¸ÐºÐ»Ð°Ð´, Ð´Ð»Ñ MQTT) Ñ‚Ð° Ð·Ñ€ÑƒÑ‡Ð½Ñƒ Ñ–Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ñ–ÑŽ Ð· GitHub.
ÐŸÐ¾Ñ€Ñ–Ð²Ð½ÑÐ»ÑŒÐ½Ð¸Ð¹ Ð°Ð½Ð°Ð»Ñ–Ð· Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼:
ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð°	ÐŸÐµÑ€ÐµÐ²Ð°Ð³Ð¸	ÐÐµÐ´Ð¾Ð»Ñ–ÐºÐ¸
Vercel	ÐŸÑ€Ð¾ÑÑ‚Ðµ CI/CD, Ð±ÐµÐ·ÑÐµÑ€Ð²ÐµÑ€Ð½Ð° Ð°Ñ€Ñ…Ñ–Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°	ÐÐµ Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÑƒÑ” Ð´Ð¾Ð²Ð³Ñ– MQTT-Ð·'Ñ”Ð´Ð½Ð°Ð½Ð½Ñ
Railway	Ð—Ñ€ÑƒÑ‡Ð½Ð¸Ð¹ CLI, Git Ñ–Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ñ–Ñ	ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð¸ Ð· timeout Ð¿Ñ€Ð¸ Ð²ÐµÐ»Ð¸ÐºÐ¾Ð¼Ñƒ Ñ‚Ñ€Ð°Ñ„Ñ–ÐºÑƒ
Heroku	ÐšÐ»Ð°ÑÐ¸Ñ‡Ð½Ð° Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÐ° Node.js	ÐŸÐ»Ð°Ñ‚Ð½Ð¸Ð¹ Ñ‚Ð°Ñ€Ð¸Ñ„ Ð¿Ñ–ÑÐ»Ñ Ð¿Ñ€Ð¾Ð±Ð½Ð¾Ð³Ð¾ Ð¿ÐµÑ€Ñ–Ð¾Ð´Ñƒ
DigitalOcean	ÐŸÐ¾Ð²Ð½Ð¸Ð¹ root-Ð´Ð¾ÑÑ‚ÑƒÐ¿, Ð¿Ð¾ÑÑ‚Ñ–Ð¹Ð½Ñ– Ð·'Ñ”Ð´Ð½Ð°Ð½Ð½Ñ, ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»ÑŒ	ÐŸÐ¾Ñ‚Ñ€Ñ–Ð±Ð½Ð¾ Ñ€ÑƒÑ‡Ð½Ðµ Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ñ–Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸


2. Ð Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ Ð±ÐµÐºÐµÐ½Ð´-ÑÐµÑ€Ð²ÐµÑ€Ð°
Ð‘ÐµÐºÐµÐ½Ð´ ÑÑ‚Ð²Ð¾Ñ€ÐµÐ½Ð¾ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ñ– Node.js + Express, Ð· Ð¿Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½ÑÐ¼ Ð´Ð¾ MongoDB Atlas Ñ‚Ð° Ð¿Ñ–Ð´Ñ‚Ñ€Ð¸Ð¼ÐºÐ¾ÑŽ RESTful API Ð´Ð»Ñ Ð²Ð·Ð°Ñ”Ð¼Ð¾Ð´Ñ–Ñ— Ð· Ð¼Ð¾Ð±Ñ–Ð»ÑŒÐ½Ð¸Ð¼ Ð´Ð¾Ð´Ð°Ñ‚ÐºÐ¾Ð¼.
ÐŸÐ¾ÑÐ»Ñ–Ð´Ð¾Ð²Ð½Ñ–ÑÑ‚ÑŒ Ð´Ñ–Ð¹:
1. Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð½Ñ Droplet (Ubuntu 22.04 LTS)
2. SSH Ð¿Ñ–Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð½Ñ

3. Ð’ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Node.js
curl -fsSL https://deb.nodesource.com/setup_18.x | bash -
apt install -y nodejs

4. ÐšÐ»Ð¾Ð½ÑƒÐ²Ð°Ð½Ð½Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ñ–ÑŽ
git clone https://github.com/NureDobrovolskaMariia/apz-pzpi-22-2-dobrovolska-mariia

5. Ð’ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ Ð·Ð°Ð»ÐµÐ¶Ð½Ð¾ÑÑ‚ÐµÐ¹
npm install

6. ÐÐ°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½Ñ Ð·Ð¼Ñ–Ð½Ð½Ð¸Ñ… ÑÐµÑ€ÐµÐ´Ð¾Ð²Ð¸Ñ‰Ð°
nano .env
PORT=3001
MONGODB_URI=mongodb+srv://...
JWT_SECRET=...
MQTT_BROKER=broker.hivemq.com:1883

7. Ð—Ð°Ð¿ÑƒÑÐº Ð±ÐµÐºÐµÐ½Ð´Ñƒ
node server.js


Ð”Ð»Ñ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÐµÐ½Ð½Ñ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ñ– Ð±ÑƒÐ»Ð¾ Ð½Ð°Ð»Ð°ÑˆÑ‚Ð¾Ð²Ð°Ð½Ð¾ UFW (Firewall) Ñ‚Ð° Ð¿Ñ€Ð¾ÐºÑÑ–Ð½Ð³ Ñ‡ÐµÑ€ÐµÐ· Nginx, Ð° Ñ‚Ð°ÐºÐ¾Ð¶ Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð½Ð¾ PM2 Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð·Ð°Ð¿ÑƒÑÐºÑƒ Ð¿Ñ–ÑÐ»Ñ Ð¿ÐµÑ€ÐµÐ·Ð°Ð²Ð°Ð½Ñ‚Ð°Ð¶ÐµÐ½Ð½Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°.



Ð’Ð˜Ð¡ÐÐžÐ’ÐšÐ˜

Ð£ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ– Ð²Ð¸ÐºÐ¾Ð½Ð°Ð½Ð½Ñ Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ñ— Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸ Ð±ÑƒÐ»Ð¾ Ð¿Ð¾Ð²Ð½Ñ–ÑÑ‚ÑŽ Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ð¾ Ñ€Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ Ð²ÑÑ–Ñ… ÐºÐ»ÑŽÑ‡Ð¾Ð²Ð¸Ñ… ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ñ–Ñ— Ð¿Ñ€Ð¾Ñ†ÐµÑÑƒ Ñ–Ð½ÐºÑƒÐ±Ð°Ñ†Ñ–Ñ— ÑÑ”Ñ†ÑŒ, Ð·Ð¾ÐºÑ€ÐµÐ¼Ð°: ÑÐµÑ€Ð²ÐµÑ€Ð½Ð¾Ñ— Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð¸ Ð½Ð° Ð±Ð°Ð·Ñ– Node.js Ð· REST API, ÐºÐ»Ñ–Ñ”Ð½Ñ‚ÑÑŒÐºÐ¾Ð³Ð¾ Android-Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½ÐºÑƒ, ÐºÐ»Ñ–Ñ”Ð½Ñ‚ÑÑŒÐºÐ¾Ð³Ð¾ web-Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½ÐºÑƒ, Ð° Ñ‚Ð°ÐºÐ¾Ð¶ IoT-ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ–Ð², Ñ‰Ð¾ Ð·Ð°Ð±ÐµÐ·Ð¿ÐµÑ‡ÑƒÑŽÑ‚ÑŒ Ð·Ð±Ñ–Ñ€ Ñ‚Ð° Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ñƒ Ð´Ð°Ð½Ð¸Ñ… Ñƒ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ñ‡Ð°ÑÑ–.
Ð¡ÐµÑ€Ð²ÐµÑ€Ð½Ð° Ñ‡Ð°ÑÑ‚Ð¸Ð½Ð° Ð±ÑƒÐ»Ð° ÑƒÑÐ¿Ñ–ÑˆÐ½Ð¾ Ð·Ð°Ð´ÐµÐ¿Ð»Ð¾Ñ”Ð½Ð° Ð½Ð° Ð²Ñ–Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾Ð¼Ñƒ Ñ…Ð¼Ð°Ñ€Ð½Ð¾Ð¼Ñƒ ÑÐµÑ€Ð²ÐµÑ€Ñ– DigitalOcean, Ñ‰Ð¾ Ð´Ð°Ð»Ð¾ Ð·Ð¼Ð¾Ð³Ñƒ Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ Ð²Ð¸ÑÐ¾ÐºÐ¾Ñ— Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ÑÑ‚Ñ– Ñ‚Ð° ÑÑ‚Ð°Ð±Ñ–Ð»ÑŒÐ½Ð¾ÑÑ‚Ñ–. Ð‘ÑƒÐ»Ð¾ Ð½Ð°Ð»Ð°ÑˆÑ‚Ð¾Ð²Ð°Ð½Ð¾ Ð±ÐµÐ·Ð¿ÐµÑ‡Ð½Ñƒ Ð²Ð·Ð°Ñ”Ð¼Ð¾Ð´Ñ–ÑŽ Ð· Ð±Ð°Ð·Ð¾ÑŽ Ð´Ð°Ð½Ð¸Ñ… MongoDB Atlas, Ñ–Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ñ–ÑŽ Ð· MQTT-Ð±Ñ€Ð¾ÐºÐµÑ€Ð¾Ð¼ Ð´Ð»Ñ Ð¾Ð±Ñ€Ð¾Ð±ÐºÐ¸ Ð°Ð»ÐµÑ€Ñ‚Ñ–Ð², Ð° Ñ‚Ð°ÐºÐ¾Ð¶ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ñ–ÑŽ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ñ–Ð² Ñ‡ÐµÑ€ÐµÐ· JWT.
ÐœÐ¾Ð±Ñ–Ð»ÑŒÐ½Ð¸Ð¹ Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½Ð¾Ðº, Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ð¸Ð¹ Ð½Ð° Kotlin, ÐµÑ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð¾ Ð²Ð·Ð°Ñ”Ð¼Ð¾Ð´Ñ–Ñ” Ð· API ÑÐµÑ€Ð²ÐµÑ€Ð°, Ð½Ð°Ð´Ð°ÑŽÑ‡Ð¸ Ð·Ñ€ÑƒÑ‡Ð½Ð¸Ð¹ Ñ–Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð´Ð»Ñ Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ Ð¿Ñ€Ð¸ÑÑ‚Ñ€Ð¾Ñ—Ð², Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½ÑŒ Ð°Ð»ÐµÑ€Ñ‚Ñ–Ð², Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¸Ñ… Ð¿Ð¾Ð´Ñ–Ð¹ Ñ‚Ð° Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ„Ñ–Ð»ÑŽ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°.
Ð Ð¾Ð·Ñ€Ð¾Ð±Ð»ÐµÐ½Ð¾ ÐºÐ»Ñ–Ñ”Ð½Ñ‚ÑÑŒÐºÑƒ Ñ‡Ð°ÑÑ‚Ð¸Ð½Ñƒ Ð²ÐµÐ±Ð´Ð¾Ð´Ð°Ñ‚ÐºÑƒ Ð´Ð»Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ñ–Ñ— Ñ–Ð½ÐºÑƒÐ±Ð°Ñ†Ñ–Ð¹Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÑÑƒ. Ð†Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ñ€ÐµÐ°Ð»Ñ–Ð·Ð¾Ð²Ð°Ð½Ð¾ Ð· Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð°Ð½Ð½ÑÐ¼ HTML, CSS Ñ‚Ð° JavaScript, Ð±ÐµÐ· Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ²Ð°Ð½Ð½Ñ ÑÑ‚Ð¾Ñ€Ð¾Ð½Ð½Ñ–Ñ… Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€ÐºÑ–Ð², Ñ‰Ð¾ Ð´Ð¾Ð·Ð²Ð¾Ð»Ð¸Ð»Ð¾ Ð´Ð¾ÑÑÐ³Ñ‚Ð¸ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ñ‚Ð¸, Ð²Ð¸ÑÐ¾ÐºÐ¾Ñ— Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ñ– Ñ‚Ð° ÐºÑ€Ð¾ÑÐ¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼ÐµÐ½Ð¾ÑÑ‚Ñ–. Ð¡Ñ‚Ð²Ð¾Ñ€ÐµÐ½Ð¾ ÐºÐ»ÑŽÑ‡Ð¾Ð²Ñ– ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÐ¸ Ð·Ð°ÑÑ‚Ð¾ÑÑƒÐ½ÐºÑƒ: Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ñ–Ñ—, Ñ€ÐµÑ”ÑÑ‚Ñ€Ð°Ñ†Ñ–Ñ—, Ð¿ÐµÑ€ÐµÐ³Ð»ÑÐ´Ñƒ Ð¿Ñ€Ð¸ÑÑ‚Ñ€Ð¾Ñ—Ð², ÑÑ‚Ð¾Ñ€Ñ–Ð½ÐºÐ¸ Ð· Ð¿Ð¾Ñ‚Ð¾Ñ‡Ð½Ð¸Ð¼Ð¸ Ñ‚Ð° ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡Ð½Ð¸Ð¼Ð¸ Ñ‚Ñ€Ð¸Ð²Ð¾Ð³Ð°Ð¼Ð¸, Ð¿Ñ€Ð¾Ñ„Ñ–Ð»ÑŽ ÐºÐ¾Ñ€Ð¸ÑÑ‚ÑƒÐ²Ð°Ñ‡Ð°, Ð° Ñ‚Ð°ÐºÐ¾Ð¶ Ð¾ÐºÑ€ÐµÐ¼Ð¾Ñ— Ð°Ð´Ð¼Ñ–Ð½-Ð¿Ð°Ð½ÐµÐ»Ñ–. 

Ð—Ð°Ð²Ð´ÑÐºÐ¸ Ð½Ð°Ð»ÐµÐ¶Ð½Ð¾Ð¼Ñƒ Ð½Ð°Ð»Ð°ÑˆÑ‚ÑƒÐ²Ð°Ð½Ð½ÑŽ Ð¼ÐµÑ€ÐµÐ¶Ñ–, Ñ…Ð¾ÑÑ‚Ð¸Ð½Ð³Ñƒ, Ð·Ð¼Ñ–Ð½Ð½Ð¸Ñ… ÑÐµÑ€ÐµÐ´Ð¾Ð²Ð¸Ñ‰Ð°, Ð»Ð¾Ð³ÑƒÐ²Ð°Ð½Ð½Ñ Ñ‚Ð° ÑƒÐ¿Ñ€Ð°Ð²Ð»Ñ–Ð½Ð½Ñ Ð¿Ñ€Ð¾Ñ†ÐµÑÐ°Ð¼Ð¸, Ð±ÑƒÐ»Ð¾ Ð´Ð¾ÑÑÐ³Ð½ÑƒÑ‚Ð¾ Ð¿Ð¾Ð²Ð½Ð¾Ñ— Ñ–Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ñ–Ñ— Ð²ÑÑ–Ñ… ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ–Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ð¸ Ð² Ñ”Ð´Ð¸Ð½Ñƒ Ñ†Ð¸Ñ„Ñ€Ð¾Ð²Ñƒ ÐµÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ. ÐžÑ‚Ñ€Ð¸Ð¼Ð°Ð½Ñ– Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¸ Ð¿Ñ–Ð´Ñ‚Ð²ÐµÑ€Ð´Ð¶ÑƒÑŽÑ‚ÑŒ ÐºÐ¾Ñ€ÐµÐºÑ‚Ð½Ñƒ Ñ€Ð¾Ð±Ð¾Ñ‚Ñƒ Ð²ÑÑ–Ñ… ÐµÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ–Ð², Ð²Ñ–Ð´Ð¿Ð¾Ð²Ñ–Ð´Ð½Ñ–ÑÑ‚ÑŒ Ð¿Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ð¼ Ñ„ÑƒÐ½ÐºÑ†Ñ–Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¸Ð¼ Ð²Ð¸Ð¼Ð¾Ð³Ð°Ð¼ Ñ‚Ð° ÐµÑ„ÐµÐºÑ‚Ð¸Ð²Ð½Ñ–ÑÑ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð½Ð¾Ñ— Ð°Ñ€Ñ…Ñ–Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð¸ Ñ€Ð¾Ð·Ð³Ð¾Ñ€Ñ‚Ð°Ð½Ð½Ñ.
Public URL: https://octopus-app-tv6oa.ondigitalocean.app/


 
Ð”ÐžÐ”ÐÐ¢ÐžÐš Ð
Ð’Ñ–Ð´ÐµÐ¾Ð·Ð°Ð¿Ð¸Ñ

Ð’Ñ–Ð´ÐµÐ¾Ð·Ð°Ð¿Ð¸Ñ	Ð¿Ñ€ÐµÐ·ÐµÐ½Ñ‚Ð°Ñ†Ñ–Ñ—	Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ–Ð²	Ð»Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð¾Ñ—	Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸:
https://youtu.be/p13-gYMGRdE

Ð¥Ñ€Ð¾Ð½Ð¾Ð»Ð¾Ð³Ñ–Ñ‡Ð½Ð¸Ð¹ Ð¾Ð¿Ð¸Ñ Ð²Ñ–Ð´ÐµÐ¾Ð·Ð°Ð¿Ð¸ÑÑƒ:

00:15 - ÐžÐ¿Ð¸Ñ ÑÑ…ÐµÐ¼Ð¸
00:50 - Ð”ÐµÐ¼Ð¾Ð½Ð¼Ñ‚Ñ€Ð°Ñ†Ñ–Ñ Ñ€Ð¾Ð±Ð¾Ñ‚Ð¸
02:30 - ÐžÐ¿Ð¸Ñ ÐºÐ¾Ð´Ñƒ Ð´Ð»Ñ ESP32
05:57 - ÐžÐ¿Ð¸Ñ ÐºÐ¾Ð´Ñƒ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ñ– 
Ð”ÐžÐ”ÐÐ¢ÐžÐš Ð‘
Ð“Ñ€Ð°Ñ„Ñ–Ñ‡Ð½Ñ– Ð¼Ð°Ñ‚ÐµÑ€Ñ–Ð°Ð»Ð¸



 
Ð Ð¸ÑÑƒÐ½Ð¾Ðº Ð‘.1 â€” Ð—Ð°Ð³Ð°Ð»ÑŒÐ½Ð° Ð°Ñ€Ñ…Ñ–Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°


 

Ð Ð¸ÑÑƒÐ½Ð¾Ðº Ð‘.3 â€” Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð±Ð°Ð·Ð¸ Ð´Ð°Ð½Ð¸Ñ…
 

 
Ð Ð¸ÑÑƒÐ½Ð¾Ðº Ð‘.1 â€“ UML Ð”Ñ–Ð°Ð³Ñ€Ð°Ð¼Ð° Ð¿Ñ€ÐµÑ†ÐµÐ´ÐµÐ½Ñ‚Ñ–Ð²





Ð”ÐžÐ”ÐÐ¢ÐžÐš Ð’
ÐŸÑ€Ð¾Ð³Ñ€Ð°Ð¼Ð½Ð¸Ð¹ ÐºÐ¾Ð´

GitHub Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ñ–Ð¹: 

https://github.com/NureDobrovolskaMariia/apz-pzpi-22-2-dobrovolska-mariia/blob/main/Lab5/pzpi-22-2-dobrovolska-mariia-lab5/server.js

ÐšÐ¾Ð´ Ð¼Ð¾Ð³Ð¾ entry point Ñƒ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ

1	// server.js
2	require('dotenv').config();
3	const express = require('express');
4	const mongoose = require('mongoose');
5	const cors = require('cors');
6	const helmet = require('helmet');
7	const rateLimit = require('express-rate-limit');
8	const path = require('path'); // Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¼Ð¾Ð´ÑƒÐ»ÑŒ path

9	// Services
10	const mqttService = require('./services/mqttService');

11	// Middleware
12	const { globalErrorHandler, notFound } = require('./middleware/errorHandler');
13	const { requestLogger, apiAnalytics, securityLogger, rateLimitLogger } = require('./middleware/logger');

14	// Routes
15	const authRoutes = require('./routes/auth');
16	const deviceRoutes = require('./routes/devices');
17	const dataRoutes = require('./routes/data');
18	const alertRoutes = require('./routes/alerts');
19	const userRoutes = require('./routes/users');

20	const app = express();
21	const PORT = process.env.PORT || 3001;

22	// Security middleware
23	app.use(
24	helmet.contentSecurityPolicy({
25	directives: {
26	...helmet.contentSecurityPolicy.getDefaultDirectives(), // Ð‘ÐµÑ€ÐµÐ¼Ð¾ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ– Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¸Ð²Ð¸
27	"script-src": ["'self'", "https://cdn.jsdelivr.net"], // Ð”Ð¾Ð·Ð²Ð¾Ð»ÑÑ”Ð¼Ð¾ 'self' Ñ‚Ð° cdn.jsdelivr.net
28	// Ð¯ÐºÑ‰Ð¾ Chart.js Ð²Ð¸ÐºÐ¾Ñ€Ð¸ÑÑ‚Ð¾Ð²ÑƒÑ” inline ÑÑ‚Ð¸Ð»Ñ– Ð°Ð±Ð¾ eval, Ð¼Ð¾Ð¶Ð»Ð¸Ð²Ð¾, Ð·Ð½Ð°Ð´Ð¾Ð±Ð¸Ñ‚ÑŒÑÑ 'unsafe-inline' Ð°Ð±Ð¾ 'unsafe-eval',
29	// Ð°Ð»Ðµ ÐºÑ€Ð°Ñ‰Ðµ Ñ†ÑŒÐ¾Ð³Ð¾ ÑƒÐ½Ð¸ÐºÐ°Ñ‚Ð¸. Ð”Ð»Ñ Chart.js v3 Ð·Ð°Ð·Ð²Ð¸Ñ‡Ð°Ð¹ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð½ÑŒÐ¾ Ð´Ð¶ÐµÑ€ÐµÐ»Ð° ÑÐºÑ€Ð¸Ð¿Ñ‚Ñƒ.
30	// "style-src": ["'self'", "https://cdn.jsdelivr.net", "'unsafe-inline'"], // ÐŸÑ€Ð¸ÐºÐ»Ð°Ð´, ÑÐºÑ‰Ð¾ Ð¿Ð¾Ñ‚Ñ€Ñ–Ð±Ð½Ñ– ÑÑ‚Ð¸Ð»Ñ– Ð· CDN
31	},
32	})
33	);
34	app.use(cors());

35	// Logging middleware
36	if (process.env.NODE_ENV === 'development') {
37	app.use(requestLogger);
38	app.use(apiAnalytics);
39	}
40	app.use(securityLogger);
41	app.use(rateLimitLogger);

42	// Rate limiting
43	const limiter = rateLimit({
44	windowMs: 15 * 60 * 100000, // 15 minutes
45	max: 100 // limit each IP to 100 requests per windowMs
46	});
47	app.use(limiter);

48	// Body parser middleware
49	app.use(express.json({ limit: '10mb' }));
50	app.use(express.urlencoded({ extended: true }));

51	// Serve static files from the 'web' directory
52	app.use(express.static(path.join(__dirname, 'web'))); //

53	// MongoDB connection
54	mongoose.connect(process.env.MONGODB_URI, {
55	useNewUrlParser: true,
56	useUnifiedTopology: true,
57	})
58	.then(() => {
59	console.log('âœ… Connected to MongoDB');
60	})
61	.catch((error) => {
62	console.error('âŒ MongoDB connection error:', error);
63	process.exit(1);
64	});

65	// Database connection events
66	mongoose.connection.on('disconnected', () => {
67	console.log('ðŸ“´ MongoDB disconnected');
68	});

69	mongoose.connection.on('error', (error) => {
70	console.error('âŒ MongoDB error:', error);
71	});

72	// Routes
73	app.get('/', (req, res) => {
74	// Instead of JSON, now serve the login page by default
75	res.sendFile(path.join(__dirname, 'web', 'html', 'login.html')); //
76	});

77	// Health check endpoint
78	app.get('/health', (req, res) => {
79	const health = {
80	status: 'OK',
81	timestamp: new Date().toISOString(),
82	uptime: process.uptime(),
83	database: mongoose.connection.readyState === 1 ? 'connected' : 'disconnected',
84	mqtt: mqttService.isConnected ? 'connected' : 'disconnected',
85	memory: process.memoryUsage(),
86	environment: process.env.NODE_ENV || 'development'
87	};

88	res.json(health);
89	});

90	// API Routes
91	app.use('/api/auth', authRoutes); //
92	app.use('/api/devices', deviceRoutes); //
93	app.use('/api/data', dataRoutes); //
94	app.use('/api/alerts', alertRoutes); //
95	app.use('/api/users', userRoutes); //

96	// MQTT test endpoint
97	app.post('/api/test/command', (req, res) => { //
98	try {
99	const { userId, deviceId, command } = req.body;

100	if (!userId || !deviceId || !command) {
101	return res.status(400).json({ error: 'Missing required fields' });
102	}

103	mqttService.sendCommand(userId, deviceId, command);
104	res.json({ message: 'Command sent successfully' });
105	} catch (error) {
106	res.status(500).json({ error: error.message });
107	}
108	});

109	// 404 handler for undefined routes
110	app.use(notFound); //

111	// Global error handling middleware
112	app.use(globalErrorHandler); //

113	// Graceful shutdown
114	process.on('SIGTERM', gracefulShutdown); //
115	process.on('SIGINT', gracefulShutdown); //

116	function gracefulShutdown(signal) { //
117	console.log(`\nðŸ“´ Received ${signal}. Graceful shutdown...`);

118	// Close MQTT connection
119	mqttService.disconnect();

120	// Close MongoDB connection
121	mongoose.connection.close(() => {
122	console.log('ðŸ“´ MongoDB connection closed');
123	process.exit(0);
124	});
125	}

126	// Start server
127	app.listen(PORT, () => {
128	console.log(`ðŸš€ Server running on port ${PORT}`);
129	console.log(`ðŸ“± Environment: ${process.env.NODE_ENV || 'development'}`);

130	// Initialize MQTT connection
131	mqttService.connect();
132	});

133	module.exports = app; 



